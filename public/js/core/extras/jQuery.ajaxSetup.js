// jQuery.ajaxSetup.js
// -------------------
// Adds the loading icon, updates icon's placement on mousemove
// Changes jQuery's ajax setup defaults
(function ()
{
	return;
	'use strict';

	// Variable used to track the mouse position
	var mouse_position = {
		top: 0
	,	left: 0
	};

	jQuery(document).ready(function ()
	{
		var $body = jQuery(document.body)
		,	$loading_icon = jQuery('#loadingIndicator');

		if (!$loading_icon.length && !SPA.ENVIRONMENT.isTouchEnabled)
		{
			// if the icon wasn't there, lets add it and make a reference in the global scope
			$loading_icon = jQuery('<img/>', {
				id: 'loadingIndicator'
			,	'class': 'global-loading-indicator'
			,	src: 'data:image/gif;base64,R0lGODlhZABkAMQRAJWVlZmZmc/Pz5ycnKCgoKOjo6enp6urq8zMzLS0tK2trbGxscXFxcnJyb+/v7u7u7e3t////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NTE0RTQyRUYxRTk0MTFFMTkwNzFBMkNEMDBGNjhGMjgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NTE0RTQyRjAxRTk0MTFFMTkwNzFBMkNEMDBGNjhGMjgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo1MTRFNDJFRDFFOTQxMUUxOTA3MUEyQ0QwMEY2OEYyOCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo1MTRFNDJFRTFFOTQxMUUxOTA3MUEyQ0QwMEY2OEYyOCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0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'
			,	css: {
					zIndex: 9999
				,	position: 'absolute'
				}
			}).hide();

			if (!_.result(SPA, 'isTestingEnv'))
			{
				$loading_icon.appendTo($body);
			}
		}

		SPA.$loadingIndicator = $loading_icon;

		// loading icon sizes, used for positioning math
		var icon_height = 16
		,	icon_width = 16;

		$body.on({
			// On mouse move, we update the icon's position, even if its not shown
			mousemove: _.throttle(function (e)
			{
				mouse_position = {
					top: Math.min($body.innerHeight() - icon_height, e.pageY + icon_width)
				,	left: Math.min($body.innerWidth() - icon_width, e.pageX + icon_height)
				};

				$loading_icon.filter(':visible').css(mouse_position);
			}, 50)
			// when the body resizes, we move the icon to the bottom of the page
			// so we don't get some empty white space at the end of the body
		,	resize: _.throttle(function ()
			{
				var icon_offset = $loading_icon.offset();
				if(!icon_offset){
					return;
				}
				mouse_position = {
					top: Math.min($body.innerHeight() - icon_height, icon_offset.top)
				,	left: Math.min($body.innerWidth() - icon_width, icon_offset.left)
				};

				$loading_icon.filter(':visible').css(mouse_position);
			}, 50)
		});
	});

	SPA.loadingIndicatorShow = function ()
	{
		SPA.$loadingIndicator && SPA.$loadingIndicator.css(mouse_position).show();
	};

	SPA.loadingIndicatorHide = function ()
	{
		SPA.$loadingIndicator && SPA.$loadingIndicator.hide();
	};

	// This registers an event listener to any ajax call
	jQuery(document)
		// http://api.jquery.com/ajaxStart/
		.ajaxStart(SPA.loadingIndicatorShow)
		// http://api.jquery.com/ajaxStop/
		.ajaxStop(SPA.loadingIndicatorHide);

	// http://api.jquery.com/jQuery.ajaxSetup/
	jQuery.ajaxSetup({
		beforeSend: function (jqXhr, options)
		{
			// BTW: "!~" means "== -1"
			if (!~options.contentType.indexOf('charset'))
			{
				// If there's no charset, we set it to UTF-8
				jqXhr.setRequestHeader('Content-Type', options.contentType + '; charset=UTF-8');
			}
		}
	});
})();
